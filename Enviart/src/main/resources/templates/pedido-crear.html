<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" th:href="@{images/favicon.jpg}" type="image/svg+xml">
    <title>Crear Pedido - Enviart</title>
    <meta name="description" content="Crea un nuevo pedido de env√≠o en Enviart">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/pedido-crear.css}">
</head>

<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">

    <!-- Navbar -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="bg-gradient-to-br from-purple-600 to-indigo-600 text-white p-2 rounded-lg">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-slate-800">Enviart</span>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-slate-600" th:text="${email}">usuario@enviart.com</span>
                    <a th:href="@{/pedidos}" class="text-purple-600 hover:text-purple-700 font-semibold text-sm">
                        ‚Üê Volver a Pedidos
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-extrabold text-slate-800 mb-3">Crear Nuevo Pedido üì¶</h1>
            <p class="text-lg text-slate-600">Complete la informaci√≥n para crear su pedido de env√≠o</p>
        </div>

        <!-- Messages -->
        <div th:if="${errorMessage}"
            class="mb-8 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
            <strong class="font-bold">Error:</strong>
            <span class="block sm:inline" th:text="${errorMessage}"></span>
        </div>

        <div th:if="${#fields.hasErrors('${pedidoDTO.*}')}"
            class="mb-8 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative">
            <strong class="font-bold">Por favor corrija los siguientes errores:</strong>
            <ul class="list-disc list-inside mt-2">
                <li th:each="err : ${#fields.errors('${pedidoDTO.*}')}" th:text="${err}"></li>
            </ul>
        </div>

        <!-- Progress Steps -->
        <div class="mb-12">
            <div class="flex items-center justify-center space-x-4">
                <div class="flex items-center">
                    <div id="step1"
                        class="step-indicator step-active w-10 h-10 rounded-full flex items-center justify-center font-bold">
                        1
                    </div>
                    <span class="ml-2 text-sm font-semibold text-slate-700">Direcciones</span>
                </div>
                <div class="w-16 h-1 bg-slate-300"></div>
                <div class="flex items-center">
                    <div id="step2"
                        class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-bold">
                        2
                    </div>
                    <span class="ml-2 text-sm font-semibold text-slate-700">Paquetes</span>
                </div>
                <div class="w-16 h-1 bg-slate-300"></div>
                <div class="flex items-center">
                    <div id="step3"
                        class="step-indicator step-inactive w-10 h-10 rounded-full flex items-center justify-center font-bold">
                        3
                    </div>
                    <span class="ml-2 text-sm font-semibold text-slate-700">Confirmar</span>
                </div>
            </div>
        </div>

        <!-- Form -->
        <form th:action="@{/pedidos/crear}" th:object="${pedidoDTO}" method="post" id="pedidoForm">

            <!-- Step 1: Direcciones -->
            <div id="stepContent1" class="bg-white rounded-2xl shadow-xl p-8 mb-6 fade-in">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">üìç Direcciones de Env√≠o</h2>

                <!-- Direcci√≥n de Origen -->
                <div class="mb-8">
                    <h3 class="text-lg font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">Origen</span>
                        Direcci√≥n de Recogida
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Nombre del Contacto *</label>
                            <input type="text" th:field="*{direccionOrigen.nombreContacto}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="Juan P√©rez" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Tel√©fono *</label>
                            <input type="tel" th:field="*{direccionOrigen.telefonoContacto}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="3001234567" pattern="[0-9]{10}" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Calle *</label>
                            <input type="text" th:field="*{direccionOrigen.calle}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="Calle 45" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">N√∫mero *</label>
                            <input type="text" th:field="*{direccionOrigen.numero}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="23-67" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">C√≥digo Postal *</label>
                            <input type="text" th:field="*{direccionOrigen.codigoPostal}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="11001" pattern="[0-9]{5}" required>
                        </div>
                    </div>
                </div>

                <!-- Direcci√≥n de Destino -->
                <div class="mb-6">
                    <h3 class="text-lg font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm">Destino</span>
                        Direcci√≥n de Entrega
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Nombre del Contacto *</label>
                            <input type="text" th:field="*{direccionDestino.nombreContacto}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="Mar√≠a Garc√≠a" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Tel√©fono *</label>
                            <input type="tel" th:field="*{direccionDestino.telefonoContacto}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="3109876543" pattern="[0-9]{10}" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Calle *</label>
                            <input type="text" th:field="*{direccionDestino.calle}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="Av. Caracas" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">N√∫mero *</label>
                            <input type="text" th:field="*{direccionDestino.numero}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="78-12" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 mb-2">C√≥digo Postal *</label>
                            <input type="text" th:field="*{direccionDestino.codigoPostal}"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                placeholder="11021" pattern="[0-9]{5}" required>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end">
                    <button type="button" onclick="nextStep(2)"
                        class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                        Siguiente: Paquetes ‚Üí
                    </button>
                </div>
            </div>

            <!-- Step 2: Paquetes -->
            <div id="stepContent2" class="bg-white rounded-2xl shadow-xl p-8 mb-6 hidden fade-in">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">üì¶ Informaci√≥n de Paquetes</h2>

                <div id="paquetesContainer">
                    <!-- Paquete 1 (template) -->
                    <div class="paquete-item border-2 border-purple-200 rounded-xl p-6 mb-4 bg-purple-50">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-slate-800">Paquete #1</h3>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Tipo de Servicio
                                    *</label>
                                <select th:field="*{paquetes[0].tipoServicioId}"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    required>
                                    <option value="">Seleccione un servicio</option>
                                    <option th:each="servicio : ${tiposServicio}" th:value="${servicio.idTipoServicio}"
                                        th:text="${servicio.nombre + ' - $' + servicio.costoBase + ' (Base)'}">
                                    </option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Peso (kg) *</label>
                                <input type="number" step="0.01" th:field="*{paquetes[0].pesoKg}"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="5.5" min="0.1" max="1000" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Largo (cm) *</label>
                                <input type="number" step="0.01" th:field="*{paquetes[0].largoCm}"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="50" min="1" max="500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Ancho (cm) *</label>
                                <input type="number" step="0.01" th:field="*{paquetes[0].anchoCm}"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="40" min="1" max="500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Alto (cm) *</label>
                                <input type="number" step="0.01" th:field="*{paquetes[0].altoCm}"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="30" min="1" max="500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Valor Declarado
                                    ($)</label>
                                <input type="number" step="0.01" th:field="*{paquetes[0].valorDeclarado}"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="1000" min="0">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Descripci√≥n del
                                    Contenido</label>
                                <textarea th:field="*{paquetes[0].descripcionContenido}" rows="2"
                                    class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="Ej: Documentos, ropa, electr√≥nicos..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between mt-6">
                    <button type="button" onclick="prevStep(1)"
                        class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-3 px-8 rounded-xl transition-all duration-300">
                        ‚Üê Anterior
                    </button>
                    <button type="button" onclick="nextStep(3)"
                        class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                        Siguiente: Confirmar ‚Üí
                    </button>
                </div>
            </div>

            <!-- Step 3: Confirmaci√≥n -->
            <div id="stepContent3" class="bg-white rounded-2xl shadow-xl p-8 mb-6 hidden fade-in">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">‚úÖ Confirmar Pedido</h2>

                <div
                    class="bg-gradient-to-r from-purple-50 to-indigo-50 border-2 border-purple-200 rounded-xl p-6 mb-6">
                    <p class="text-lg text-slate-700 mb-4">
                        Por favor, revise la informaci√≥n antes de confirmar su pedido.
                    </p>
                    <p class="text-sm text-slate-600">
                        Una vez creado, recibir√° un n√∫mero de seguimiento y podr√° ver el estado de su env√≠o en tiempo
                        real.
                    </p>
                </div>

                <div class="flex justify-between">
                    <button type="button" onclick="prevStep(2)"
                        class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-3 px-8 rounded-xl transition-all duration-300">
                        ‚Üê Anterior
                    </button>
                    <button type="submit"
                        class="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                        Crear Pedido
                    </button>
                </div>
            </div>

        </form>

    </div>

    <script th:src="@{/js/pedido-crear.js}"></script>

</body>

</html>