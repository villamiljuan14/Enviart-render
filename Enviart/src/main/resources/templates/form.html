<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Usuario</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">

    <div
        class="bg-white shadow-2xl rounded-xl w-full max-w-2xl p-10 transform transition duration-500 hover:shadow-3xl">
        <h2 class="text-3xl font-extrabold text-center text-green-700 mb-8 border-b pb-4">
            <span th:text="${usuario.idUsuario == null ? 'Crear Nuevo Usuario' : 'Editar Usuario'}"></span>
        </h2>

        <!-- Mensaje de error -->
        <div th:if="${error}" class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
            <strong>Error:</strong> <span th:text="${error}"></span>
        </div>

        <!-- Mensaje de éxito -->
        <div th:if="${mensaje}" class="mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
            <strong>Éxito:</strong> <span th:text="${mensaje}"></span>
        </div>

        <form th:action="@{${accion}}" th:object="${usuario}" method="post"
            class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- 1. IDENTIFICADOR (Oculto) -->
            <div class="col-span-full">
                <input type="hidden" th:field="*{idUsuario}" />
            </div>

            <!-- 2. Tipo de Documento -->
            <div>
                <label for="tipoDocumento" class="block text-gray-700 font-semibold mb-1">
                    Tipo Documento
                </label>
                <select id="tipoDocumento" th:field="*{tipoDocumento}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150">
                    <option value="" disabled>Selecciona tipo</option>
                    <!-- Aquí puedes añadir más tipos de documento según sea necesario -->
                    <option value="CC">Cédula de Ciudadanía (CC)</option>
                    <option value="TI">Tarjeta de Identidad (TI)</option>
                    <option value="CE">Cédula de Extranjería (CE)</option>
                    <option value="PAS">Pasaporte (PAS)</option>
                </select>
            </div>

            <!-- 3. Número de Documento (docUsuario) -->
            <div>
                <label for="docUsuario" class="block text-gray-700 font-semibold mb-1">
                    Número de Documento
                </label>
                <input type="text" id="docUsuario" th:field="*{docUsuario}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 4. Primer Nombre -->
            <div>
                <label for="primerNombre" class="block text-gray-700 font-semibold mb-1">
                    Primer Nombre
                </label>
                <input type="text" id="primerNombre" th:field="*{primerNombre}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 5. Segundo Nombre (Opcional) -->
            <div>
                <label for="segundoNombre" class="block text-gray-700 font-semibold mb-1">
                    Segundo Nombre (Opcional)
                </label>
                <input type="text" id="segundoNombre" th:field="*{segundoNombre}"
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 6. Primer Apellido -->
            <div>
                <label for="primerApellido" class="block text-gray-700 font-semibold mb-1">
                    Primer Apellido
                </label>
                <input type="text" id="primerApellido" th:field="*{primerApellido}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 7. Segundo Apellido (Opcional) -->
            <div>
                <label for="segundoApellido" class="block text-gray-700 font-semibold mb-1">
                    Segundo Apellido (Opcional)
                </label>
                <input type="text" id="segundoApellido" th:field="*{segundoApellido}"
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 8. Teléfono -->
            <div>
                <label for="telefono" class="block text-gray-700 font-semibold mb-1">
                    Teléfono
                </label>
                <input type="tel" id="telefono" th:field="*{telefono}"
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 9. Correo electrónico (Email) -->
            <div>
                <label for="email" class="block text-gray-700 font-semibold mb-1">
                    Correo electrónico
                </label>
                <input type="email" id="email" th:field="*{email}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150" />
            </div>

            <!-- 10. Contraseña (contrasenaUsuario) -->
            <div>
                <label for="contrasenaUsuario" class="block text-gray-700 font-semibold mb-1">
                    Contraseña
                </label>
                <!-- La contraseña es requerida solo al crear (idUsuario es nulo) -->
                <input type="password" id="contrasenaUsuario" th:field="*{contrasenaUsuario}"
                    th:required="${usuario.idUsuario == null}"
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150"
                    placeholder="Solo requerido al crear. Dejar en blanco para no cambiar." />
            </div>

            <!-- 11. Estado del Usuario (estadoUsuario) -->
            <div>
                <label for="estadoUsuario" class="block text-gray-700 font-semibold mb-1">
                    Estado
                </label>
                <select id="estadoUsuario" th:field="*{estadoUsuario}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150">
                    <option value="true">Activo</option>
                    <option value="false">Inactivo</option>
                </select>
            </div>

            <!-- 12. Rol (rol) -->
            <div>
                <label for="rol" class="block text-gray-700 font-semibold mb-1">
                    Rol
                </label>
                <select id="rol" th:field="*{rol.idRol}" required
                    class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-green-500 transition duration-150">
                    <option value="">Selecciona un rol</option>
                    <option th:each="r : ${listaRoles}" th:value="${r.idRol}" th:text="${r.tipoRol}">
                        Rol Ejemplo
                    </option>
                </select>
            </div>

            <!-- Botones de acción -->
            <div class="col-span-full flex justify-between pt-8 border-t mt-6">
                <a th:href="@{/usuarios}"
                    class="bg-gray-400 text-white px-8 py-3 rounded-lg font-bold hover:bg-gray-500 transition duration-150 shadow-md">
                    Cancelar
                </a>
                <button type="submit"
                    class="bg-green-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-green-700 transition duration-150 shadow-xl">
                    <span th:text="${usuario.idUsuario == null ? 'Registrar Usuario' : 'Confirmar Cambios'}"></span>
                </button>
            </div>
        </form>
    </div>

</body>

</html>